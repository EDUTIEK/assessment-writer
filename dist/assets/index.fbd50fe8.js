import{l as z,d as V,a as D,D as ge,m as le,b as p,w as u,v as g,u as a,o as h,c as w,e as l,f as o,V as _,g as d,t as x,h as y,i as I,j as F,k as ie,n as B,p as K,q as H,F as O,r as te,s as M,x as me,y as de,z as k,A as fe,B as ce,C as U,E as oe,G as se,H as pe,I as _e,J as ye,K as we,L as P,M as ne,N as he,O as ue,P as ve,Q as Se,R as ke,S as Ie}from"./vendor.efdeafee.js";const xe=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const c of r.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function n(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerpolicy&&(r.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?r.credentials="include":s.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(s){if(s.ep)return;s.ep=!0;const r=n(s);fetch(s.href,r)}};xe();const Z=z.createInstance({storeName:"writer-settings",description:"Settings data"}),J=V("settings",{state:()=>({headline_scheme:null,formatting_options:null,notice_boards:null,copy_allowed:null}),actions:{setData(e){this.headline_scheme=e.headline_scheme,this.formatting_options=e.formatting_options,this.notice_boards=e.notice_boards,this.copy_allowed=e.copy_allowed},async clearStorage(){try{await Z.clear()}catch(e){console.log(e)}},async loadFromStorage(){try{const e=await Z.getItem("settings");this.setData(e)}catch(e){console.log(e)}},async loadFromData(e){try{await Z.setItem("settings",e),this.setData(e)}catch(t){console.log(t)}}}}),Q=z.createInstance({storeName:"writer-layout",description:"Layout data"}),q=V("layout",{state:()=>({expandedColumn:"left",leftContent:"instructions",rightContent:"essay",showTimer:!0}),getters:{isLeftExpanded:e=>e.expandedColumn=="left",isRightExpanded:e=>e.expandedColumn=="right",isLeftVisible:e=>e.expandedColumn!="right",isRightVisible:e=>e.expandedColumn!="left",isInstructionsSelected:e=>e.leftContent=="instructions",isResourcesSelected:e=>e.leftContent=="resources",isInstructionsVisible:e=>e.expandedColumn!="right"&&e.leftContent=="instructions",isResourcesVisible:e=>e.expandedColumn!="right"&&e.leftContent=="resources",isEssayVisible:e=>e.expandedColumn!="left"&&e.rightContent=="essay"},actions:{async clearStorage(){try{await Q.clear()}catch(e){console.log(e)}},async loadFromStorage(){try{const e=await Q.getItem("layout");e&&(this.expandedColumn=e.expandedColumn,this.rightContent=e.rightContent,this.showTimer=e.showTimer)}catch(e){console.log(e)}},async saveToStorage(){try{await Q.setItem("layout",{expandedColumn:this.expandedColumn,leftContent:this.leftContent,rightContent:this.rightContent,showTimer:this.showTimer})}catch(e){console.log(e)}},showInstructions(){this.setLeftVisible(),this.leftContent="instructions",this.saveToStorage()},showResources(){this.setLeftVisible(),this.leftContent="resources",this.saveToStorage()},showEssay(){this.setRightVisible(),this.rightContent="essay",this.saveToStorage()},setLeftVisible(){this.isLeftVisible||(this.expandedColumn="left",this.saveToStorage())},setRightVisible(){this.isRightVisible||(this.expandedColumn="right",this.saveToStorage())},setLeftExpanded(e){this.expandedColumn=e?"left":"none",this.saveToStorage()},setRightExpanded(e){this.expandedColumn=e?"right":"none",this.saveToStorage()},toggleTimer(){this.showTimer=!this.showTimer,this.saveToStorage()}}}),b=z.createInstance({storeName:"writer-resources",description:"Resource data"}),N=V("resources",{state:()=>({keys:[],resources:[],activeKey:""}),getters:{hasResources:e=>e.resources.length>0,activeTitle(e){const t=e.resources.find(n=>n.key==e.activeKey);return t?t.title:""},getResource(e){return t=>e.resources.find(n=>n.key==t)},isActive(e){return t=>e.activeKey==t.key}},actions:{async clearStorage(){try{await b.clear()}catch(e){console.log(e)}},async loadFromStorage(){var e;try{const t=await b.getItem("resourceKeys");t&&(this.keys=JSON.parse(t)),this.activeKey=(e=await b.getItem("activeKey"))!=null?e:[],this.resources=[];let n=0;for(;n<this.keys.length;){let i=await b.getItem(this.keys[n]);this.resources.push(i),n++}await this.loadFiles()}catch(t){console.log(t)}},async loadFromData(e){const t=L();try{await b.clear(),this.keys=[],this.resources=[];let n=0;for(;n<e.length;){let i=e[n];i.url=t.resourceUrl(i.key),this.resources.push(i),this.keys.push(i.key),await b.setItem(i.key,i),n++}await b.setItem("resourceKeys",JSON.stringify(this.keys)),await b.setItem("activeKey",this.activeKey),await this.loadFiles()}catch(n){console.log(n)}},async selectResource(e){this.activeKey=e.key,await b.setItem("activeKey",this.activeKey)},async loadFiles(){let e=0;for(;e<this.keys.length;){let t=this.getResource(this.keys[e]),n=null;if(t.type=="file")try{console.log("preload "+t.title+"..."),n=await D(t.url,{responseType:"blob",timeout:6e4}),t.objectUrl=URL.createObjectURL(n.data),console.log("finished. ")}catch(i){return console.error(i),!1}e++}}}}),f=z.createInstance({storeName:"writer-essay",description:"Essay data"}),R=new ge,X=1e3,be=5e3,Ce=5e3,Te=10,Ee=1e3,Y={storedContent:"",storedHash:"",history:[],lastStoredIndex:-1,lastSentIndex:-1,lastSentHash:"",currentContent:"",sumOfDistances:0,lastCheck:0,lastSave:0,lastSending:0};let A=0,re=0;const $=V("essay",{state:()=>Y,getters:{hasHistory:e=>e.history.length>0,historyLength:e=>e.history.length,openSendings:e=>e.lastStoredIndex-e.lastSentIndex,unsentHistory(e){let t=[],n=e.lastSentIndex+1;for(;n<e.history.length;)t.push(e.history[n]),n++;return t},formatTimestamp(){return e=>new Date(e).toISOString().slice(0,19).replace("T"," ")},formatIndex(){return e=>e.toString().padStart(9,"0")},makeHash(){return(e,t)=>le(e+t)}},actions:{async clearStorage(){try{await f.clear()}catch(e){console.log(e)}},addToHistory(e,t=0){let n=this.history.push(e)-1;return e.is_delta?this.sumOfDistances+=t:this.sumOfDistances=0,n},async loadFromData(e){var t,n,i;A=1;try{this.$state=Y,this.currentContent=(t=e.content)!=null?t:"",this.storedContent=(n=e.content)!=null?n:"",this.storedHash=(i=e.hash)!=null?i:"",await f.clear(),await f.setItem("storedContent",this.storedContent),await f.setItem("storedHash",this.storedHash);let s=0;for(;s<e.steps.length;){let r=e.steps[s],c={is_delta:r.is_delta,timestamp:r.timestamp,content:r.content,hash_before:r.hash_before,hash_after:r.hash_after};this.addToHistory(c),await f.setItem(this.formatIndex(s),c),s++}this.lastStoredIndex=this.history.length-1,this.lastSentIndex=this.history.length-1,this.lastSentHash=this.storedHash,await f.setItem("lastStoredIndex",this.lastStoredIndex),await f.setItem("lastSentIndex",this.lastSentIndex),await f.setItem("lastSentHash",this.lastSentHash)}catch(s){console.log(s)}A=0,setInterval(this.updateContent,X)},async loadFromStorage(){var e,t,n,i,s;A=1;try{this.$state=Y,this.lastStoredIndex=(e=await f.getItem("lastStoredIndex"))!=null?e:-1,this.lastSentIndex=(t=await f.getItem("lastSentIndex"))!=null?t:-1,this.lastSentHash=(n=await f.getItem("lastSentHash"))!=null?n:"",this.storedContent=(i=await f.getItem("storedContent"))!=null?i:"",this.storedHash=(s=await f.getItem("storedHash"))!=null?s:"",this.currentContent=this.storedContent;let r=0;for(;r<=this.lastStoredIndex;){let c=await f.getItem(this.formatIndex(r));if(c==null)break;this.addToHistory(c),r++}}catch(r){console.log(r)}A=0,setInterval(this.updateContent,X)},async updateContent(e=!1){const t=L(),n=Date.now();if(!(n-this.lastCheck<X||A++||C().writingEndReached)){try{const s=this.currentContent+"";let r=null;if(s!=this.storedContent){const c=this.makeHash(s,t.serverTime(n));let m=R.diff_main(this.storedContent,s);R.diff_cleanupEfficiency(m);const v=R.diff_levenshtein(m),S=R.patch_toText(R.patch_make(this.storedContent,m)),G=R.patch_apply(R.patch_fromText(S),this.storedContent);this.history.length==0||S.length>s.length||this.sumOfDistances+v>Ee||G[0]!=s?r={is_delta:0,timestamp:t.serverTime(n),content:s,hash_before:this.storedHash,hash_after:c}:(v>=Te||n-this.lastSave>be)&&(r={is_delta:1,timestamp:t.serverTime(n),content:S,hash_before:this.storedHash,hash_after:c}),r!==null&&(this.lastStoredIndex=this.addToHistory(r,v),this.lastSave=n,this.storedContent=s,this.storedHash=c,await f.setItem("storedContent",this.storedContent),await f.setItem("storedHash",this.storedHash),await f.setItem(this.formatIndex(this.lastStoredIndex),r),await f.setItem("lastStoredIndex",this.lastStoredIndex),console.log("Delta:",r.is_delta,"| Distance (sum): ",v,"(",this.sumOfDistances,")","| Editor: ",e,"| Duration:",Date.now()-n,"ms"))}this.lastCheck=n,this.sendUpdate()}catch(s){console.error(s)}A=0}},async sendUpdate(){if(Date.now()-this.lastSending<Ce||re++)return;let e=[],t=this.lastSentIndex,n=this.lastSentHash,i=this.lastSentIndex+1;for(;i<this.history.length;)e.push(this.history[i]),n=this.history[i].hash_after,t=i++;e.length>0&&(await L().saveWritingStepsToBackend(e)&&(this.lastSentIndex=t,await f.setItem("lastSentIndex",t),await f.setItem("lastSentHash",n)),this.lastSending=Date.now()),re=!1},async hasUnsentSavingsInStorage(){var e,t;return this.lastStoredIndex=(e=await f.getItem("lastStoredIndex"))!=null?e:-1,this.lastSentIndex=(t=await f.getItem("lastSentIndex"))!=null?t:-1,this.lastStoredIndex>this.lastSentIndex},async hasHashInStorage(e){var t;return this.lastSentHash=(t=await f.getItem("lastSentHash"))!=null?t:"",e==this.lastSentHash}}}),E=z.createInstance({storeName:"writer-alerts",description:"Alert Messages"}),ae=V("alerts",{state:()=>({keys:[],alerts:[],activeKey:"",showAllAlerts:!1}),getters:{countAlerts:e=>e.alerts.length,hasAlerts:e=>e.alerts.length>0,hasActiveAlert:e=>e.activeKey!="",activeMessage(e){const t=e.alerts.find(n=>n.key==e.activeKey);return t?t.message:""},getAlert(e){return t=>e.alerts.find(n=>n.key==t)},formatTimestamp(){return e=>new Date(e*1e3).toLocaleString()}},actions:{showAlerts(){this.showAllAlerts=!0},hideAlert(){this.activeKey="",this.showAllAlerts=!1},async clearStorage(){try{await E.clear()}catch(e){console.log(e)}},async loadFromStorage(){var e;try{const t=await E.getItem("alertKeys");t&&(this.keys=JSON.parse(t)),this.activeKey=(e=await E.getItem("activeKey"))!=null?e:"",this.alerts=[];let n=0;for(;n<this.alerts.length;){let i=await E.getItem(this.keys[n]);this.alerts.push(i),n++}}catch(t){console.log(t)}},async loadFromData(e){try{await E.clear();let t=[],n=[],i=0;for(;i<e.length;){let s=e[i];typeof this.getAlert(s.key)=="undefined"&&(this.activeKey=s.key),n.push(s),t.push(s.key),await E.setItem(s.key,s),i++}this.keys=t,this.alerts=n,await E.setItem("alertKeys",JSON.stringify(this.keys)),await E.setItem("activeKey",this.activeKey)}catch(t){console.log(t)}}}}),L=V("api",{state:()=>({backendUrl:"",returnUrl:"",userKey:"",environmentKey:"",dataToken:"",fileToken:"",timeOffset:0,initialized:!1,review:!1,showInitFailure:!1,showReplaceConfirmation:!1,showReloadConfirmation:!1,showFinalizeFailure:!1,showAuthorizeFailure:!1}),getters:{requestConfig(e){return function(t){let n=e.backendUrl,i=new URLSearchParams,s=n.search(/\?+/);return s!=-1&&(i=new URLSearchParams(n.substr(s)),n=n.substr(0,s)),i.append("LongEssayUser",e.userKey),i.append("LongEssayEnvironment",e.environmentKey),i.append("LongEssaySignature",le(e.userKey+e.environmentKey+t)),{baseURL:n,params:i,timeout:3e4,responseType:"json",responseEncoding:"utf8"}}},resourceUrl(){return function(e){const t=this.requestConfig(this.fileToken);return t.baseURL+"/file/"+e+"?"+t.params.toString()}},serverTime(e){return t=>t==0?0:Math.floor((t-e.timeOffset)/1e3)}},actions:{async init(){var i;let e=!1,t=p.get("LongEssayHash");if(this.backendUrl=localStorage.getItem("writerBackendUrl"),this.returnUrl=localStorage.getItem("writerReturnUrl"),this.userKey=localStorage.getItem("writerUserKey"),this.environmentKey=localStorage.getItem("writerEnvironmentKey"),this.dataToken=localStorage.getItem("writerDataToken"),this.fileToken=localStorage.getItem("writerFileToken"),this.timeOffset=Math.floor((i=localStorage.getItem("writerTimeOffset"))!=null?i:0),!!p.get("LongEssayUser")&&p.get("LongEssayUser")!==this.userKey&&(this.userKey=p.get("LongEssayUser"),e=!0),!!p.get("LongEssayEnvironment")&&p.get("LongEssayEnvironment")!==this.environmentKey&&(this.environmentKey=p.get("LongEssayEnvironment"),e=!0),!!p.get("LongEssayBackend")&&p.get("LongEssayBackend")!==this.backendUrl&&(this.backendUrl=p.get("LongEssayBackend")),!!p.get("LongEssayReturn")&&p.get("LongEssayReturn")!==this.returnUrl&&(this.returnUrl=p.get("LongEssayReturn")),!!p.get("LongEssayToken")&&p.get("LongEssayToken")!==this.dataToken&&(this.dataToken=p.get("LongEssayToken")),!this.backendUrl||!this.returnUrl||!this.userKey||!this.environmentKey||!this.dataToken){this.showInitFailure=!0;return}const n=$();e?await n.hasUnsentSavingsInStorage()?(console.log("init: new context, open savings"),this.showReplaceConfirmation=!0):(console.log("init: new context, no open savings"),await this.loadDataFromBackend()):t?await n.hasHashInStorage(t)?(console.log("init: same context, same hash"),await this.loadDataFromStorage()):await n.hasUnsentSavingsInStorage()?(console.log("init: same context, hashes differ, open savings"),this.showReloadConfirmation=!0):(console.log("init: same context, hashes differ, no open savings"),await this.loadDataFromBackend()):await n.hasUnsentSavingsInStorage()?(console.log("init: same context, no server hash, open savings"),await this.loadDataFromStorage()):(console.log("init: same context, no server hash, no open savings"),await this.loadDataFromBackend()),setInterval(this.checkUpdate,5e3)},async loadDataFromStorage(){console.log("loadDataFromStorage..."),this.updateConfig();const e=J(),t=C(),n=N(),i=$(),s=q();await e.loadFromStorage(),await t.loadFromStorage(),await n.loadFromStorage(),await i.loadFromStorage(),await s.loadFromStorage(),this.initialized=!0},async loadDataFromBackend(){console.log("loadDataFromBackend..."),this.updateConfig();let e={};try{e=await D.get("/data",this.requestConfig(this.dataToken)),this.setTimeOffset(e),this.refreshToken(e)}catch(r){console.error(r),this.showInitFailure=!0;return}const t=J(),n=C(),i=N(),s=$();await t.loadFromData(e.data.settings),await n.loadFromData(e.data.task),await i.loadFromData(e.data.resources),await s.loadFromData(e.data.essay),e.data.essay.started||await this.sendStart(),this.initialized=!0},async checkUpdate(){let e={};try{e=await D.get("/update",this.requestConfig(this.dataToken)),this.setTimeOffset(e),this.refreshToken(e)}catch(i){return console.error(i),!1}await C().loadFromData(e.data.task),await ae().loadFromData(e.data.alerts)},async sendStart(){let e={},t={started:this.serverTime(Date.now())};try{return e=await D.put("/start",t,this.requestConfig(this.dataToken)),this.setTimeOffset(e),this.refreshToken(e),!0}catch(n){return console.error(n),this.showInitFailure=!0,!1}},async saveWritingStepsToBackend(e){let t={},n={steps:e};try{return t=await D.put("/steps",n,this.requestConfig(this.dataToken)),this.setTimeOffset(t),this.refreshToken(t),!0}catch(i){return console.error(i),!1}},async saveFinalContentToBackend(e,t,n,i){let s={},r={steps:e,content:t,hash:n,authorized:i};try{return s=await D.put("/final",r,this.requestConfig(this.dataToken)),this.refreshToken(s),!0}catch(c){return console.error(c),!1}},updateConfig(){p.remove("LongEssayBackend"),p.remove("LongEssayReturn"),p.remove("LongEssayUser"),p.remove("LongEssayEnvironment"),p.remove("LongEssayToken"),p.remove("LongEssayHash"),localStorage.setItem("writerBackendUrl",this.backendUrl),localStorage.setItem("writerReturnUrl",this.returnUrl),localStorage.setItem("writerUserKey",this.userKey),localStorage.setItem("writerEnvironmentKey",this.environmentKey),localStorage.setItem("writerDataToken",this.dataToken),localStorage.setItem("writerFileToken",this.fileToken)},setTimeOffset(e){const t=e.headers.longessaytime*1e3,n=Date.now();this.timeOffset=n-t,localStorage.setItem("writerTimeOffset",this.timeOffset)},refreshToken(e){e.headers.longessaydatatoken&&(this.dataToken=e.headers.longessaydatatoken,localStorage.setItem("writerDataToken",this.dataToken)),e.headers.longessayfiletoken&&(this.fileToken=e.headers.longessayfiletoken,localStorage.setItem("writerFileToken",this.fileToken))},async finalize(e){const t=J(),n=C(),i=N(),s=$(),r=q();if((e||s.openSendings>0)&&!await this.saveFinalContentToBackend(s.unsentHistory,s.storedContent,s.storedHash,e)){this.showFinalizeFailure=!0,this.showAuthorizeFailure=e;return}await t.clearStorage(),await n.clearStorage(),await i.clearStorage(),await s.clearStorage(),await r.clearStorage(),localStorage.clear(),window.location=this.returnUrl}}}),ee=z.createInstance({storeName:"writer-task",description:"Task data"}),C=V("task",{state:()=>({title:null,writer_name:null,instructions:null,writing_end:null,remaining_time:null}),getters:{hasWritingEnd:e=>!!e.writing_end,writingEndReached:e=>e.remaining_time===0},actions:{setData(e){this.title=e.title,this.instructions=e.instructions,this.writer_name=e.writer_name,this.writing_end=e.writing_end},async clearStorage(){try{await ee.clear()}catch(e){console.log(e)}},async loadFromStorage(){try{const e=await ee.getItem("task");this.setData(e)}catch(e){console.log(e)}this.updateRemainingTime(),setInterval(this.updateRemainingTime,1e3)},async loadFromData(e){try{await ee.setItem("task",e),this.setData(e)}catch(t){console.log(t)}this.updateRemainingTime(),setInterval(this.updateRemainingTime,1e3)},updateRemainingTime(){const e=L();this.writing_end?this.remaining_time=Math.max(0,this.writing_end-e.serverTime(Date.now())):this.remaining_time=null,this.writingEndReached&&(e.review=!0)}}}),Le={setup(e){const t=C(),n=q();function i(s){const r=("00"+Math.floor(s)%60).slice(-2),c=("00"+Math.floor(s/60)%60).slice(-2),m=("00"+Math.floor(s/3600)%24).slice(-2),v=Math.floor(s/86400);return v>1?v+" Tage "+m+" Stunden":v>0?v+" Tag "+m+" Stunden":m!="00"?m+":"+c+":"+r+" Stunden":c!="00"?c+":"+r+" Minuten":r+" Sekunden"}return(s,r)=>u((h(),w(y,{onClick:r[0]||(r[0]=c=>a(n).toggleTimer())},{default:l(()=>[o(_,{left:"",icon:"mdi-clock-outline"}),u(d("span",null,x(i(a(t).remaining_time)),513),[[g,a(n).showTimer]])]),_:1},512)),[[g,!a(t).writingEndReached]])}},Re=M(" Nachricht der Aufsicht: "),$e=d("span",null,"OK",-1),Fe=M(" Nachrichten der Aufsicht: "),Ve=d("br",null,null,-1),Ae=d("span",null,"OK",-1),De={setup(e){const t=ae();return(n,i)=>(h(),I(O,null,[u(o(y,{onClick:i[0]||(i[0]=s=>a(t).showAlerts())},{default:l(()=>[o(_,{left:"",icon:"mdi-bell-outline"}),u(d("span",null,"1 Nachricht",512),[[g,a(t).countAlerts==1]]),u(d("span",null,x(a(t).countAlerts)+" Nachrichten",513),[[g,a(t).countAlerts>1]])]),_:1},512),[[g,a(t).hasAlerts]]),o(H,{persistent:"",modelValue:a(t).hasActiveAlert,"onUpdate:modelValue":i[2]||(i[2]=s=>a(t).hasActiveAlert=s)},{default:l(()=>[o(F,null,{default:l(()=>[o(ie,null,{default:l(()=>[Re]),_:1}),o(B,null,{default:l(()=>[d("p",null,x(a(t).activeMessage),1)]),_:1}),o(K,null,{default:l(()=>[o(y,{onClick:i[1]||(i[1]=s=>a(t).hideAlert())},{default:l(()=>[o(_,{left:"",icon:"mdi-check"}),$e]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),o(H,{persistent:"",modelValue:a(t).showAllAlerts,"onUpdate:modelValue":i[4]||(i[4]=s=>a(t).showAllAlerts=s)},{default:l(()=>[o(F,null,{default:l(()=>[o(ie,null,{default:l(()=>[Fe]),_:1}),o(B,null,{default:l(()=>[(h(!0),I(O,null,te(a(t).alerts,s=>(h(),I(O,{key:s.key},[d("p",null,[d("strong",null,x(a(t).formatTimestamp(s.time)),1)]),d("p",null,x(s.message),1),Ve],64))),128))]),_:1}),o(K,null,{default:l(()=>[o(y,{onClick:i[3]||(i[3]=s=>a(t).hideAlert())},{default:l(()=>[o(_,{left:"",icon:"mdi-check"}),Ae]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}},Ue=d("span",null,"Beenden ...",-1),Be=M("Unterbrechen"),Ke=M("Vorschau / Abgabe ..."),He={setup(e){const t=L(),n=C(),i=ae();function s(){var r;return(n.writer_name==null?"":n.writer_name+", ")+((r=n.title)!=null?r:"")}return(r,c)=>(h(),w(se,{elevation:"1",color:"white",density:"compact"},{default:l(()=>[o(me,null,{default:l(()=>[M(x(s()),1)]),_:1}),o(de),a(i).hasAlerts?(h(),w(De,{key:0})):k("",!0),a(n).hasWritingEnd?(h(),w(Le,{key:1})):k("",!0),u(o(y,null,{default:l(()=>[o(_,{left:"",icon:"mdi-logout-variant"}),Ue,o(fe,{activator:"parent",anchor:"bottom end",origin:"end top"},{default:l(()=>[o(F,null,{default:l(()=>[o(ce,null,{default:l(()=>[o(U,{href:a(t).returnUrl},{default:l(()=>[o(oe,null,{default:l(()=>[Be]),_:1})]),_:1},8,["href"]),o(U,{onClick:c[0]||(c[0]=m=>a(t).review=!0)},{default:l(()=>[o(oe,null,{default:l(()=>[Ke]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},512),[[g,!a(t).review]])]),_:1}))}};var j=(e,t)=>{const n=e.__vccOpts||e;for(const[i,s]of t)n[i]=s;return n};const Oe={setup(e){const t=q(),n=N();function i(){document.getElementById("app-navigation-drawer").dispatchEvent(new Event("mouseenter"))}function s(){document.getElementById("app-navigation-drawer").dispatchEvent(new Event("mouseleave"))}function r(m){m.type=="url"?window.open(m.source,"long-essay-writer-resource-"+m.key):(n.selectResource(m),t.showResources())}function c(m){switch(m.type){case"url":return n.isActive(m)&&t.isResourcesVisible?"mdi-file-link":"mdi-file-link-outline";default:return n.isActive(m)&&t.isResourcesVisible?"mdi-file":"mdi-file-outline"}}return(m,v)=>(h(),w(ye,{id:"app-navigation-drawer",elevation:"2",color:"grey-lighten-4",width:"500",permanent:"",rail:"","expand-on-hover":""},{default:l(()=>[o(ce,{color:"grey-lighten-4"},{default:l(()=>[o(U,{onClick:v[0]||(v[0]=S=>{a(t).showInstructions(),s()}),"prepend-icon":a(t).isInstructionsVisible?"mdi-text-box":"mdi-text-box-outline",title:"Aufgabenstellung"},null,8,["prepend-icon"]),o(U,{onClick:v[1]||(v[1]=S=>{a(t).showEssay(),s()}),"prepend-icon":a(t).isEssayVisible?"mdi-file-edit":"mdi-file-edit-outline",title:"Essay schreiben"},null,8,["prepend-icon"]),u(o(pe,null,{activator:l(({props:S})=>[o(U,_e(S,{onMouseenter:v[2]||(v[2]=G=>i()),"prepend-icon":a(t).isResourcesVisible?"mdi-book-open":"mdi-book-open-outline",title:"Material"}),null,16,["prepend-icon"])]),default:l(()=>[(h(!0),I(O,null,te(a(n).resources,S=>(h(),w(U,{onClick:G=>{r(S),s()},"prepend-icon":c(S),title:S.title,key:S.key},null,8,["onClick","prepend-icon","title"]))),128))]),_:1},512),[[g,a(n).hasResources]])]),_:1})]),_:1}))}};var Ne=j(Oe,[["__scopeId","data-v-bbfa5284"]]);const ze={setup(e){const t=$();return(n,i)=>(h(),w(se,{position:"bottom",height:"48",color:"grey-lighten-5",elevation:"1"},{default:l(()=>[M(" \xC4nderungen: "+x(a(t).historyLength)+" | Zu senden: "+x(a(t).openSendings),1)]),_:1}))}};const Me=["innerHTML"],qe={setup(e){const t=C();return(n,i)=>(h(),I("div",{id:"app-instructions",innerHTML:a(t).instructions},null,8,Me))}};var je=j(qe,[["__scopeId","data-v-e8fd4a6e"]]);const Pe={class:"resources"},Je={key:0},We=["data"],Ge={setup(e){const t=N();return(n,i)=>(h(),I("div",Pe,[(h(!0),I(O,null,te(a(t).resources,s=>(h(),I(O,{key:s.key},[s.type=="file"?u((h(),I("div",Je,[s.mimetype=="application/pdf"?(h(),I("object",{key:0,type:"application/pdf",data:s.objectUrl,width:"100%",height:"100%"},null,8,We)):k("",!0)],512)),[[g,a(t).isActive(s)]]):k("",!0)],64))),128))]))}};var Ze=j(Ge,[["__scopeId","data-v-2e61ae4e"]]);const Qe={setup(e){const t=$(),n=J();function i(){switch(n.formatting_options){case"full":return"undo redo | formatselect | bold italic underline | bullist numlist | removeformat | charmap";case"medium":return"undo redo | bold italic underline | bullist numlist | removeformat | charmap";case"minimal":return"undo redo | bold italic underline | removeformat | charmap";case"none":default:return"undo redo | charmap"}}const s="essay";return(r,c)=>(h(),w(a(we),{id:s,modelValue:a(t).currentContent,"onUpdate:modelValue":c[0]||(c[0]=m=>a(t).currentContent=m),onChange:c[1]||(c[1]=m=>a(t).updateContent(!0)),onKeyup:c[2]||(c[2]=m=>a(t).updateContent(!0)),"api-key":"no-api-key",init:{height:"100%",menubar:!1,plugins:"lists charmap",toolbar:i(),custom_undo_redo_levels:10}},null,8,["modelValue","init"]))}};const W=e=>(he("data-v-439538ca"),e=e(),ue(),e),Xe={class:"container"},Ye={class:"col-header"},et={class:"text-h6"},tt={class:"col-content"},st=W(()=>d("span",null,"Mein Text",-1)),nt=W(()=>d("span",null,"Erweitern",-1)),at=W(()=>d("div",{class:"col-header"},[d("h2",{class:"text-h6"},"Mein Text")],-1)),it={class:"col-content"},ot=W(()=>d("span",null,"Erweitern",-1)),rt={setup(e){const t=q(),n=N();return(i,s)=>(h(),w(ne,{"fill-height":""},{default:l(()=>[d("div",Xe,[u(d("div",{class:P(["column",{colExpanded:a(t).isLeftExpanded,colNormal:!a(t).isLeftExpanded}])},[d("div",Ye,[u(d("h2",et,"Aufgabenstellung",512),[[g,a(t).isInstructionsVisible]]),u(d("h2",{class:"text-h6"},x(a(n).activeTitle),513),[[g,a(t).isResourcesVisible]])]),d("div",tt,[u(o(je,null,null,512),[[g,a(t).isInstructionsVisible]]),u(o(Ze,null,null,512),[[g,a(t).isResourcesVisible]])]),d("div",{class:P(["col-footer text-right",{footerExpanded:a(t).isLeftExpanded,footerNormal:!a(t).isLeftExpanded}])},[u(o(y,{class:"ma-2",onClick:s[0]||(s[0]=r=>a(t).setLeftExpanded(!1))},{default:l(()=>[o(_,{icon:"mdi-chevron-left"}),st]),_:1},512),[[g,a(t).isLeftExpanded]]),u(o(y,{class:"ma-2",onClick:s[1]||(s[1]=r=>a(t).setLeftExpanded(!0))},{default:l(()=>[nt,o(_,{icon:"mdi-chevron-right"})]),_:1},512),[[g,!a(t).isLeftExpanded]])],2)],2),[[g,a(t).isLeftVisible]]),u(d("div",{class:P(["column",{colExpanded:a(t).isRightExpanded,colNormal:!a(t).isRightExpanded}])},[at,d("div",it,[o(Qe)]),d("div",{class:P(["col-footer text-left",{footerExpanded:a(t).isRightExpanded,footerNormal:!a(t).isRightExpanded}])},[u(o(y,{class:"ma-2",onClick:s[2]||(s[2]=r=>a(t).setRightExpanded(!0))},{default:l(()=>[o(_,{icon:"mdi-chevron-left"}),ot]),_:1},512),[[g,!a(t).isRightExpanded]]),u(o(y,{class:"ma-2",onClick:s[3]||(s[3]=r=>a(t).setRightExpanded(!1))},{default:l(()=>[u(d("span",null,"Aufgabenstellung",512),[[g,a(t).isInstructionsSelected]]),u(d("span",null,x(a(n).activeTitle),513),[[g,a(t).isResourcesSelected]]),o(_,{icon:"mdi-chevron-right"})]),_:1},512),[[g,a(t).isRightExpanded]])],2)],2),[[g,a(t).isRightVisible]])])]),_:1}))}};var lt=j(rt,[["__scopeId","data-v-439538ca"]]);const dt=d("p",null,"Lade Daten...",-1),ct=d("span",null,"Beenden ...",-1),ht=d("p",null,"Beim Laden der Daten ist ein Fehler aufgetreten. Die Anwendung kann nicht gestartet werden.",-1),ut=d("span",null,"Beenden",-1),gt=d("p",null,"In Ihrem Browser sind Eingaben eines anderen Benutzers oder einer anderen Aufgabe vorhanden, die noch nicht \xFCbertragen wurden. Durch das Laden werden diese Eingaben gel\xF6scht.",-1),mt=d("p",null,"M\xF6chten Sie die neue Aufgabe laden?",-1),ft=d("span",null,"Laden",-1),pt=d("span",null,"Abbrechen",-1),_t=d("p",null,"In Ihrem Browser sind Eingaben vorhanden, die noch nicht \xFCbertragen wurden. Die letzte im System gespeicherte Eingabe scheint aber nicht aus diesem Browser zu stammen. Das kann z.B. passieren, wenn Ihre Netzverbindung unterbrochen wurde und Sie anschlie\xDFend in einem anderen Browser weitergearbeitet haben. Durch das Laden werden Ihre Eingaben im Browser \xFCberschrieben.",-1),yt=d("p",null,"M\xF6chten Sie die Eingabe vom System laden?",-1),wt=d("span",null,"Laden",-1),vt=d("span",null,"Abbrechen",-1),St={setup(e){const t=L();return(n,i)=>(h(),w(ne,{"fill-height":""},{default:l(()=>[o(se,{elevation:"1",color:"white",density:"compact"},{default:l(()=>[dt,o(de),o(y,{href:a(t).returnUrl},{default:l(()=>[o(_,{left:"",icon:"mdi-logout-variant"}),ct]),_:1},8,["href"])]),_:1}),o(H,{persistent:"",modelValue:a(t).showInitFailure,"onUpdate:modelValue":i[0]||(i[0]=s=>a(t).showInitFailure=s)},{default:l(()=>[o(F,null,{default:l(()=>[o(B,null,{default:l(()=>[ht]),_:1}),o(K,null,{default:l(()=>[o(y,{href:a(t).returnUrl},{default:l(()=>[o(_,{left:"",icon:"mdi-logout-variant"}),ut]),_:1},8,["href"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),o(H,{persistent:"",modelValue:a(t).showReplaceConfirmation,"onUpdate:modelValue":i[2]||(i[2]=s=>a(t).showReplaceConfirmation=s)},{default:l(()=>[o(F,null,{default:l(()=>[o(B,null,{default:l(()=>[gt,mt]),_:1}),o(K,null,{default:l(()=>[o(y,{onClick:i[1]||(i[1]=s=>a(t).loadDataFromBackend())},{default:l(()=>[o(_,{left:"",icon:"mdi-reload"}),ft]),_:1}),o(y,{href:a(t).returnUrl},{default:l(()=>[o(_,{left:"",icon:"mdi-logout-variant"}),pt]),_:1},8,["href"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),o(H,{persistent:"",modelValue:a(t).showReloadConfirmation,"onUpdate:modelValue":i[4]||(i[4]=s=>a(t).showReloadConfirmation=s)},{default:l(()=>[o(F,null,{default:l(()=>[o(B,null,{default:l(()=>[_t,yt]),_:1}),o(K,null,{default:l(()=>[o(y,{onClick:i[3]||(i[3]=s=>a(t).loadDataFromBackend())},{default:l(()=>[o(_,{left:"",icon:"mdi-reload"}),wt]),_:1}),o(y,{href:a(t).returnUrl},{default:l(()=>[o(_,{left:"",icon:"mdi-logout-variant"}),vt]),_:1},8,["href"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}};const T=e=>(he("data-v-42b06605"),e=e(),ue(),e),kt={class:"container"},It={class:"column"},xt={class:"col-header bg-grey-lighten-4"},bt=T(()=>d("h2",{class:"text-h6"},"Ihre Bearbeitungszeit ist beendet",-1)),Ct=T(()=>d("p",null,"Es ist keine weitere Eingabe m\xF6glich. Bitte \xFCberpr\xFCfen Sie, ob Sie den Text in dieser Form zur Bewertung abgeben m\xF6chten.",-1)),Tt=[bt,Ct],Et={class:"col-header bg-grey-lighten-4"},Lt=T(()=>d("h2",{class:"text-h6"},"Abgabe-Text",-1)),Rt=T(()=>d("p",null,"Bitte \xFCberpr\xFCfen Sie, ob Sie den Text in dieser Form zur Bwertung abgeben m\xF6chten. Nach der Abgabe ist keine weitere Bearbeitung mehr m\xF6glich!",-1)),$t=[Lt,Rt],Ft={class:"col-content"},Vt=["innerHTML"],At={class:"col-footer text-right bg-grey-lighten-4"},Dt=T(()=>d("span",null,"Zur Bewertung abgeben",-1)),Ut=T(()=>d("span",null,"Ohne Abgabe beenden",-1)),Bt=T(()=>d("span",null,"Weiter bearbeiten",-1)),Kt=T(()=>d("span",null,"Sp\xE4ter versuchen",-1)),Ht=T(()=>d("span",null,"Ohne Speichern beenden",-1)),Ot={setup(e){const t=L(),n=$(),i=C();return(s,r)=>(h(),w(ne,{"fill-height":""},{default:l(()=>[d("div",kt,[d("div",It,[u(d("div",xt,Tt,512),[[g,a(i).writingEndReached]]),u(d("div",Et,$t,512),[[g,!a(i).writingEndReached]]),d("div",Ft,[d("div",{class:"review-text",innerHTML:a(n).storedContent},null,8,Vt)]),d("div",At,[o(y,{class:"ma-2",onClick:r[0]||(r[0]=c=>a(t).finalize(!0)),color:"secondary"},{default:l(()=>[o(_,{icon:"mdi-file-send-outline"}),Dt]),_:1}),u(o(y,{class:"ma-2",onClick:r[1]||(r[1]=c=>a(t).finalize(!1))},{default:l(()=>[o(_,{icon:"mdi-logout-variant"}),Ut]),_:1},512),[[g,a(i).writingEndReached]]),u(o(y,{class:"ma-2",onClick:r[2]||(r[2]=c=>a(t).review=!1)},{default:l(()=>[o(_,{icon:"mdi-file-edit-outline"}),Bt]),_:1},512),[[g,!a(i).writingEndReached]])])])]),o(H,{persistent:"",modelValue:a(t).showFinalizeFailure,"onUpdate:modelValue":r[4]||(r[4]=c=>a(t).showFinalizeFailure=c)},{default:l(()=>[o(F,null,{default:l(()=>[o(B,null,{default:l(()=>[u(d("p",null,"Beim Speichern der Abgabe ist ein Fehler aufgetreten. Bitte versuchen Sie es sp\xE4ter noch einmal.",512),[[g,a(t).showAuthorizeFailure]]),u(d("p",null,"Beim Speichern Ihrer letzten \xC4nderungen ist ein Fehler aufgetreten. Bitte versuchen Sie es sp\xE4ter noch einmal.",512),[[g,!a(t).showFinalizeFailure]])]),_:1}),o(K,null,{default:l(()=>[o(y,{onClick:r[3]||(r[3]=c=>a(t).showFinalizeFailure=!1)},{default:l(()=>[o(_,{left:"",icon:"mdi-close"}),Kt]),_:1}),o(y,{href:a(t).returnUrl},{default:l(()=>[o(_,{left:"",icon:"mdi-logout-variant"}),Ht]),_:1},8,["href"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}};var Nt=j(Ot,[["__scopeId","data-v-42b06605"]]);const zt={setup(e){const t=L();return t.init(),(n,i)=>(h(),w(ve,{"fill-height":""},{default:l(()=>[a(t).initialized?k("",!0):(h(),w(St,{key:0})),a(t).initialized?(h(),w(He,{key:1})):k("",!0),a(t).initialized?(h(),w(ze,{key:2})):k("",!0),a(t).initialized&&!a(t).review?(h(),w(Ne,{key:3})):k("",!0),a(t).initialized&&!a(t).review?(h(),w(lt,{key:4})):k("",!0),a(t).initialized&&a(t).review?(h(),w(Nt,{key:5})):k("",!0)]),_:1}))}};var Mt=Se();ke(zt).use(Ie()).use(Mt).mount("#app");
